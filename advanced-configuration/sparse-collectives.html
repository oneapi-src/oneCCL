
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Sparse collective operations &#8212; oneCCL  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicons.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Enabling OFI/verbs dmabuf support" href="dmabuf.html" />
    <link rel="prev" title="Unordered collectives support" href="unordered-collectives.html" />
    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "oneapi-ccl"; // WAP team will give you a unique section for your site
        // Load TMS
        (function () {
        var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
    </script>
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/oneAPI-rgb-rev-100.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">oneCCL  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/release-notes.html">
   Release Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/installation.html">
   Installation Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/sample.html">
   Sample Application
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction/cmake-configuration.html">
   Use oneCCL package from CMake
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Developer Guide
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../programming-model.html">
   Programming Model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../programming-model/host-communication.html">
     Host Communication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../programming-model/device-communication.html">
     Device Communication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../programming-model/limitations.html">
     Limitations
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../general-configuration.html">
   General Configuration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../general-configuration/operation-execution.html">
     Execution of Communication Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../general-configuration/transport-selection.html">
     Transport selection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../advanced-configuration.html">
   Advanced Configuration
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="collective-algorithms-selection.html">
     Selection of Collective Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operation-caching.html">
     Caching of Communication Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operation-prioritization.html">
     Prioritization of Communication Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="operation-fusion.html">
     Fusion of Communication Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="unordered-collectives.html">
     Unordered collectives support
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Sparse collective operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dmabuf.html">
     Enabling OFI/verbs dmabuf support
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Developer Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api.html">
   oneCCL API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/initialization.html">
     Initialization
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/concepts.html">
     oneCCL Concepts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/communicator.html">
       Communicator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/context.html">
       Context
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/device.html">
       Device
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/event.html">
       Event
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/kvs.html">
       Key-value Store
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/concepts/stream.html">
       Stream
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/operations.html">
     Communication operations
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/operations/datatypes.html">
       Datatypes
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../api/operations/collective-operations.html">
       Collective Operations
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/allgatherv.html">
         Allgatherv
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/allreduce.html">
         Allreduce
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/alltoall.html">
         Alltoall
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/alltoallv.html">
         Alltoallv
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/barrier.html">
         Barrier
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/broadcast.html">
         Broadcast
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/reduce.html">
         Reduce
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/reduce-scatter.html">
         ReduceScatter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../api/operations/collective-operations/sparse-allreduce.html">
         SparseAllreduce
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../env-variables.html">
   Environment Variables
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Notices and Disclaimers
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../legal.html">
   Notices and Disclaimers
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/advanced-configuration/sparse-collectives.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/oneapi-src/oneCCL/issues/new?title=Issue%20on%20page%20%2Fadvanced-configuration/sparse-collectives.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/oneapi-src/oneCCL/edit/master/doc/source/advanced-configuration/sparse-collectives.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="sparse-collective-operations">
<h1>Sparse collective operations<a class="headerlink" href="#sparse-collective-operations" title="Permalink to this headline">¶</a></h1>
<p>Language models typically feature huge embedding tables within their topology.
This makes straight-forward gradient computation followed by <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> for the whole set of weights not feasible in practice
due to both performance and memory footprint reasons.
Thus, gradients for such layers are usually computed for a smaller sub-tensor on each iteration, and communication pattern,
which is required to average the gradients across processes, does not map well to allreduce API.</p>
<p>To address these scenarios, frameworks usually utilize the <code class="docutils literal notranslate"><span class="pre">allgather</span></code> primitive, which may be suboptimal if there is a lot of intersections between sub-tensors from different processes.</p>
<p>Latest research paves the way to handling such communication in a more optimal manner, but each of these approaches has its own application area.
The ultimate goal of oneCCL is to provide a common API for sparse collective operations that would simplify framework design by allowing under-the-hood implementation of different approaches.</p>
<p>oneCCL can work with sparse tensors represented by two tensors: one for indices and one for values.</p>
<p>Sparse allreduce is a collective communication operation that makes global reduction operation on sparse buffers from all ranks of communicator and distributes result back to all ranks. Sparse buffers are defined by separate index and value buffers.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">ccl</span><span class="o">::</span><span class="n">event</span> <span class="n">sparse_allreduce</span><span class="p">(</span><span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">send_ind_buf</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">send_ind_count</span><span class="p">,</span>
                            <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">send_val_buf</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">send_val_count</span><span class="p">,</span>
                            <span class="kt">void</span><span class="o">*</span> <span class="n">recv_ind_buf</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">recv_ind_count</span><span class="p">,</span>
                            <span class="kt">void</span><span class="o">*</span> <span class="n">recv_val_buf</span><span class="p">,</span>
                            <span class="kt">size_t</span> <span class="n">recv_val_count</span><span class="p">,</span>
                            <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span> <span class="n">ind_dtype</span><span class="p">,</span>
                            <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span> <span class="n">val_dtype</span><span class="p">,</span>
                            <span class="n">ccl</span><span class="o">::</span><span class="n">reduction</span> <span class="n">rtype</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">ccl</span><span class="o">::</span><span class="n">communicator</span><span class="o">&amp;</span> <span class="n">comm</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">ccl</span><span class="o">::</span><span class="n">stream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">ccl</span><span class="o">::</span><span class="n">sparse_allreduce_attr</span><span class="o">&amp;</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">ccl</span><span class="o">::</span><span class="n">default_sparse_allreduce_attr</span><span class="p">,</span>
                            <span class="k">const</span> <span class="n">ccl</span><span class="o">::</span><span class="n">vector_class</span><span class="o">&lt;</span><span class="n">ccl</span><span class="o">::</span><span class="n">event</span><span class="o">&gt;&amp;</span> <span class="n">deps</span> <span class="o">=</span> <span class="p">{});</span>
</pre></div>
</div>
<dl class="simple">
<dt>send_ind_buf</dt><dd><p>the buffer of indices with <code class="docutils literal notranslate"><span class="pre">send_ind_count</span></code> elements of type <code class="docutils literal notranslate"><span class="pre">ind_dtype</span></code></p>
</dd>
<dt>send_ind_count</dt><dd><p>the number of elements of type <code class="docutils literal notranslate"><span class="pre">ind_type</span></code> in <code class="docutils literal notranslate"><span class="pre">send_ind_buf</span></code></p>
</dd>
<dt>send_val_buf</dt><dd><p>the buffer of values with <code class="docutils literal notranslate"><span class="pre">send_val_count</span></code> elements of type <code class="docutils literal notranslate"><span class="pre">val_dtype</span></code></p>
</dd>
<dt>send_val_count</dt><dd><p>the number of elements of type <code class="docutils literal notranslate"><span class="pre">val_type</span></code> in  <code class="docutils literal notranslate"><span class="pre">send_val_buf</span></code></p>
</dd>
<dt>recv_ind_buf [out]</dt><dd><p>the buffer to store reduced indices, unused</p>
</dd>
<dt>recv_ind_count [out]</dt><dd><p>the number of elements in <code class="docutils literal notranslate"><span class="pre">recv_ind_buf</span></code>, unused</p>
</dd>
<dt>recv_val_buf [out]</dt><dd><p>the buffer to store reduced values, unused</p>
</dd>
<dt>recv_val_count [out]</dt><dd><p>the number of elements in <code class="docutils literal notranslate"><span class="pre">recv_val_buf</span></code>, unused</p>
</dd>
<dt>ind_dtype</dt><dd><p>the datatype of elements in <code class="docutils literal notranslate"><span class="pre">send_ind_buf</span></code> and <code class="docutils literal notranslate"><span class="pre">recv_ind_buf</span></code></p>
</dd>
<dt>val_dtype</dt><dd><p>the the datatype of elements in <code class="docutils literal notranslate"><span class="pre">send_val_buf</span></code> and <code class="docutils literal notranslate"><span class="pre">recv_val_buf</span></code></p>
</dd>
<dt>rtype</dt><dd><p>the type of the reduction operation to be applied</p>
</dd>
<dt>comm</dt><dd><p>the communicator that defines a group of ranks for the operation</p>
</dd>
<dt>stream</dt><dd><p>an optional stream associated with the operation</p>
</dd>
<dt>attr</dt><dd><p>optional attributes to customize the operation</p>
</dd>
<dt>deps</dt><dd><p>an optional vector of the events that the operation should depend on</p>
</dd>
<dt>return <code class="docutils literal notranslate"><span class="pre">event</span></code></dt><dd><p>an object to track the progress of the operation</p>
</dd>
</dl>
<p>For <code class="docutils literal notranslate"><span class="pre">sparse_allreduce</span></code>, a completion callback or an allocation callback is required.</p>
<p>Use the following fields in operation attribute:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">completion_fn</span></code> - a completion callback function pointer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alloc_fn</span></code> - an allocation callback function pointer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fn_ctx</span></code>- an user context pointer of type <code class="docutils literal notranslate"><span class="pre">void*</span></code></p></li>
</ul>
<p>Completion callback should follow the signature:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">completion_fn</span><span class="p">)</span>
<span class="p">(</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span><span class="p">,</span>   <span class="cm">/* idx_buf      */</span>
    <span class="kt">size_t</span><span class="p">,</span>        <span class="cm">/* idx_count    */</span>
    <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span><span class="p">,</span> <span class="cm">/* idx_dtype    */</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span><span class="p">,</span>   <span class="cm">/* val_buf      */</span>
    <span class="kt">size_t</span><span class="p">,</span>        <span class="cm">/* val_count    */</span>
    <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span><span class="p">,</span> <span class="cm">/* val_dtype    */</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>    <span class="cm">/* user_context */</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">idx_buf</span></code> and <code class="docutils literal notranslate"><span class="pre">val_buf</span></code> are temporary buffers.
Thus, the data from these buffers should be copied. Use <code class="docutils literal notranslate"><span class="pre">user_context</span></code> for this purpose.</p>
<p>Allocation callback should follow the signature:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">*</span><span class="n">alloc_fn</span><span class="p">)</span>
<span class="p">(</span>
    <span class="kt">size_t</span><span class="p">,</span>        <span class="cm">/* idx_count    */</span>
    <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span><span class="p">,</span> <span class="cm">/* idx_dtype    */</span>
    <span class="kt">size_t</span><span class="p">,</span>        <span class="cm">/* val_count    */</span>
    <span class="n">ccl</span><span class="o">::</span><span class="n">datatype</span><span class="p">,</span> <span class="cm">/* val_dtype    */</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span><span class="p">,</span>   <span class="cm">/* user_context */</span>
    <span class="kt">void</span><span class="o">**</span><span class="p">,</span>        <span class="cm">/* out_idx_buf  */</span>
    <span class="kt">void</span><span class="o">**</span>         <span class="cm">/* out_val_buf  */</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">ccl::sparse_allreduce</span></code> is experimental and subject to change.</p>
</div>
</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="unordered-collectives.html" title="previous page">Unordered collectives support</a>
    <a class='right-next' id="next-link" href="dmabuf.html" title="next page">Enabling OFI/verbs dmabuf support</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Intel<br/>
        
            &copy; Copyright 2019–2021.<br/>
          <div class="extra_footer">
            <p align="right"><a href="https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">Cookies</a></p>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>