

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>oneCCL Benchmark User Guide &#8212; oneCCL  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <link rel="shortcut icon" href="_static/favicons.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notices and Disclaimers" href="legal.html" />
    <link rel="prev" title="Environment Variables" href="env-variables.html" />
    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "oneapi-ccl"; // WAP team will give you a unique section for your site
        // Load TMS
        (function () {
        var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
    </script>
    <link href="_static/style.css" rel="stylesheet" type="text/css">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/oneAPI-rgb-rev-100.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/oneAPI-rgb-rev-100.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/sample.html">Sample Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction/cmake-configuration.html">Use oneCCL package from CMake</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="programming-model.html">Programming Model</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="programming-model/host-communication.html">Host Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming-model/device-communication.html">Device Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming-model/limitations.html">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="general-configuration.html">General Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="general-configuration/operation-execution.html">Execution of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="general-configuration/transport-selection.html">Transport Selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced-configuration.html">Advanced Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/collective-algorithms-selection.html">Selection of Collective Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/low-precision-datatypes.html">Low-precision Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/operation-caching.html">Caching of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/operation-prioritization.html">Prioritization of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/operation-fusion.html">Fusion of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-configuration/dmabuf.html">Enabling OFI/verbs/dmabuf Support</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">oneCCL API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/initialization.html">Initialization</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/concepts.html">oneCCL Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/communicator.html">Communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/context.html">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/device.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/event.html">Event</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/kvs.html">Key-value Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/concepts/stream.html">Stream</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/operations.html">Communication Operations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/operations/datatypes.html">Datatypes</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/operations/collective-operations.html">Collective Operations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/allgatherv.html">Allgatherv</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/allreduce.html">Allreduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/alltoall.html">Alltoall</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/alltoallv.html">Alltoallv</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/barrier.html">Barrier</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/broadcast.html">Broadcast</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/reduce.html">Reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/operations/collective-operations/reduce-scatter.html">ReduceScatter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api/operations/point-to-point.html">Point-To-Point Operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="env-variables.html">Environment Variables</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Benchmark User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">oneCCL Benchmark User Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notices and Disclaimers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="legal.html">Notices and Disclaimers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/oneapi-src/oneCCL/edit/master/doc/rst/source/benchmark.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/oneapi-src/oneCCL/issues/new?title=Issue%20on%20page%20%2Fbenchmark.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/benchmark.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>oneCCL Benchmark User Guide</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-oneccl-benchmark">Build oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-only">CPU-Only</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-gpu">CPU-GPU</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oneccl-benchmark">Run oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-arguments">Benchmark Arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu">GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu">CPU</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="oneccl-benchmark-user-guide">
<h1>oneCCL Benchmark User Guide<a class="headerlink" href="#oneccl-benchmark-user-guide" title="Permalink to this headline">#</a></h1>
<p>The oneCCL benchmark provides performance measurements for the collective operations in oneCCL, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">allreduce</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allgather</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alltoall</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alltoallv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce-scatter</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">broadcast</span></code></p></li>
</ul>
<p>The benchmark is distributed with the oneCCL package. You can find it in the examples directory within the oneCCL installation path.</p>
<section id="build-oneccl-benchmark">
<h2>Build oneCCL Benchmark<a class="headerlink" href="#build-oneccl-benchmark" title="Permalink to this headline">#</a></h2>
<section id="cpu-only">
<h3>CPU-Only<a class="headerlink" href="#cpu-only" title="Permalink to this headline">#</a></h3>
<p>To build the benchmark, complete the following steps:</p>
<ol class="arabic">
<li><p>Configure your environment. Source the installed oneCCL library for the CPU-only support:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">source</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ccl</span><span class="w"> </span><span class="n">installation</span><span class="w"> </span><span class="n">dir</span><span class="o">&gt;/</span><span class="n">ccl</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">env</span><span class="o">/</span><span class="n">vars</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="o">--</span><span class="n">ccl</span><span class="o">-</span><span class="n">configuration</span><span class="o">=</span><span class="n">cpu</span>
</pre></div>
</div>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">&lt;oneCCL</span> <span class="pre">install</span> <span class="pre">location&gt;/share/doc/ccl/examples</span></code></p></li>
<li><p>Build the benchmark with the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="n">$</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">_install</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="o">--</span><span class="n">build</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">nproc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">install</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="cpu-gpu">
<h3>CPU-GPU<a class="headerlink" href="#cpu-gpu" title="Permalink to this headline">#</a></h3>
<ol class="arabic">
<li><p>Configure your environment.</p>
<ul>
<li><p>Source the Intel(R) oneAPI DPC++/C++ Compiler. See the <a class="reference external" href="https://www.intel.com/content/www/us/en/docs/dpcpp-cpp-compiler/get-started-guide/current/overview.html">documentation</a> for the instructions.</p></li>
<li><p>Source the installed oneCCL library for the CPU-GPU support:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">source</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ccl</span><span class="w"> </span><span class="n">installation</span><span class="w"> </span><span class="n">dir</span><span class="o">&gt;/</span><span class="n">ccl</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">env</span><span class="o">/</span><span class="n">vars</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="o">--</span><span class="n">ccl</span><span class="o">-</span><span class="n">configuration</span><span class="o">=</span><span class="n">cpu_gpu_dpcpp</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">&lt;oneCCL</span> <span class="pre">install</span> <span class="pre">location&gt;/share/doc/ccl/examples</span></code>.</p></li>
<li><p>Build the SYCL benchmark with the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">icx</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">icpx</span><span class="w"> </span><span class="o">-</span><span class="n">DCOMPUTE_BACKEND</span><span class="o">=</span><span class="n">dpcpp</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="n">$</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">_install</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="o">--</span><span class="n">build</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">nproc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">install</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="run-oneccl-benchmark">
<h2>Run oneCCL Benchmark<a class="headerlink" href="#run-oneccl-benchmark" title="Permalink to this headline">#</a></h2>
<p>To run the benchmark, use the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">np</span><span class="w"> </span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">benchmark</span><span class="w"> </span><span class="p">[</span><span class="n">arguments</span><span class="p">]</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> is the overall number of processes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> is the number of processes within a node</p></li>
</ul>
<p>The benchmark reports:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#bytes</span></code> - the message size in the number of bytes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#repetitions</span></code> - the number of iterations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_min</span></code> - the average time across iterations of the fastest process in each iteration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_max</span></code> - the average time across iterations of the slowest process in each iteration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_avg</span></code> - the average time across processes and iterations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stddev</span></code> - standard deviation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait_t_avg</span></code> - the average wait time after the collective call returns and until it completes To enable, use the <code class="docutils literal notranslate"><span class="pre">-x</span></code> option.</p></li>
</ul>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">t_min</span></code>, <code class="docutils literal notranslate"><span class="pre">t_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">t_avg</span></code> measure the total collective execution time. It means the timer starts before calling oneCCL API and ends once the collective completes.
While <code class="docutils literal notranslate"><span class="pre">wait_t_avg</span></code> only measures the wait time. It means the timer starts after the collective API call returns control to the host/calling thread and ends once the collective completes.
Thus, <code class="docutils literal notranslate"><span class="pre">wait_t_avg</span></code> does not include the time spent on the oneCCL API call, while <code class="docutils literal notranslate"><span class="pre">t_min</span></code>, <code class="docutils literal notranslate"><span class="pre">t_max</span></code>, and <code class="docutils literal notranslate"><span class="pre">t_avg</span></code> include that time. Time is reported in <cite>Î¼sec</cite>.</p>
<section id="benchmark-arguments">
<h3>Benchmark Arguments<a class="headerlink" href="#benchmark-arguments" title="Permalink to this headline">#</a></h3>
<p>To see the benchmark arguments, use the <code class="docutils literal notranslate"><span class="pre">--help</span></code> argument.</p>
<p>The benchmark accepts the following arguments:</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 25%" />
<col style="width: 50%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--backend</span></code></p></td>
<td><p>Specify the backend. The possible values are <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">sycl</span></code>. For a CPU-only build, the backend is automatically set to <code class="docutils literal notranslate"><span class="pre">host</span></code>, and only the host option is available.
For a CPU-GPU build, <code class="docutils literal notranslate"><span class="pre">host</span></code> and <code class="docutils literal notranslate"><span class="pre">sycl</span></code> options are available, and <code class="docutils literal notranslate"><span class="pre">sycl</span></code> is the default value. The host value allocates buffers in the host (CPU) memory, while the <code class="docutils literal notranslate"><span class="pre">sycl</span></code> value allocates buffers in the device (GPU) memory.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sycl</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-i</span></code>, <code class="docutils literal notranslate"><span class="pre">--iters</span></code></p></td>
<td><p>Specify the number of iterations executed by the benchmark.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-w</span></code>, <code class="docutils literal notranslate"><span class="pre">--warmup_iters</span></code></p></td>
<td><p>Specify the number of the warmup iterations. It means the number of iterations the benchmark runs before starting the timing of the iterations specified with the <code class="docutils literal notranslate"><span class="pre">-i</span></code> argument.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-j</span></code>, <code class="docutils literal notranslate"><span class="pre">--iter_policy</span></code></p></td>
<td><p>Specify the iteration policy. Possible values are <code class="docutils literal notranslate"><span class="pre">off</span></code> and <code class="docutils literal notranslate"><span class="pre">auto</span></code>.
When the iteration policy is <code class="docutils literal notranslate"><span class="pre">off</span></code>, the number of iterations is the same across the message sizes.
When the iteration policy is <code class="docutils literal notranslate"><span class="pre">auto</span></code>, the number of iterations reduces based on the message size of the collective operation.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">auto</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-n</span></code>, <code class="docutils literal notranslate"><span class="pre">--buf_count</span></code></p></td>
<td><p>Specify the number of collective operations the benchmark calls in each iteration. Each collective uses different <code class="docutils literal notranslate"><span class="pre">send</span></code> and <code class="docutils literal notranslate"><span class="pre">receive</span></code> buffers.
The explicit wait calls are placed for each collective after all of them are called.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-f</span></code>, <code class="docutils literal notranslate"><span class="pre">--min_elem_count</span></code></p></td>
<td><p>Specify the minimum number of elements used for the collective.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-t</span></code>, <code class="docutils literal notranslate"><span class="pre">--max_elem_count</span></code></p></td>
<td><p>Specify the maximum number of elements used for the collective.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">128</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-y</span></code>, <code class="docutils literal notranslate"><span class="pre">--elem_counts</span></code></p></td>
<td><p>Specify a list with the number of elements used for the collective, , such as <code class="docutils literal notranslate"><span class="pre">[-y</span> <span class="pre">4,</span> <span class="pre">8,</span> <span class="pre">32,</span> <span class="pre">131072]</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">8,</span> <span class="pre">16,</span> <span class="pre">32,</span> <span class="pre">64,</span> <span class="pre">128]</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--check</span></code></p></td>
<td><p>Check for correctness. The possible values are <code class="docutils literal notranslate"><span class="pre">off</span></code> (disable checking), <code class="docutils literal notranslate"><span class="pre">last</span></code> (check the last iteration), and <code class="docutils literal notranslate"><span class="pre">all</span></code> (check all the iterations).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">last</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>, <code class="docutils literal notranslate"><span class="pre">--cache</span></code></p></td>
<td><p>Specify whether to use persistent collectives (<code class="docutils literal notranslate"><span class="pre">p=1</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">p=0</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A collective is persistent when the same collective is called with the same parameters multiple times. OneCCL generates a schedule for each collective it runs and can apply optimizations when persistent collectives are used.
It means the schedule is generated once and reused across the subsequent invocations, saving the time to generate the schedule.</p>
</div>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-q</span></code>, <code class="docutils literal notranslate"><span class="pre">--inplace</span></code></p></td>
<td><p>Specify for oneCCL to use in-place (<code class="docutils literal notranslate"><span class="pre">1</span></code>) or out-of-place (<code class="docutils literal notranslate"><span class="pre">0</span></code>) buffers. With the in-place buffers, the send and receive buffers used by the collective are the same.
With the out-of-place, the buffers are different.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-a</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_dev_type</span></code></p></td>
<td><p>Specify the type of the SYCL device. The possible values are <code class="docutils literal notranslate"><span class="pre">host</span></code>, <code class="docutils literal notranslate"><span class="pre">cpu</span></code>, and <code class="docutils literal notranslate"><span class="pre">gpu</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-g</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_root_dev</span></code></p></td>
<td><p>Specify to use the root devices (<code class="docutils literal notranslate"><span class="pre">0</span></code>) and sub-devices (<code class="docutils literal notranslate"><span class="pre">1</span></code>).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-m</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_mem_type</span></code></p></td>
<td><p>Specify the type of SYCL memory. The possible values are <code class="docutils literal notranslate"><span class="pre">usm</span></code> (unified shared memory) and <code class="docutils literal notranslate"><span class="pre">buf</span></code> (buffers).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">usm</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-u</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_usm_type</span></code></p></td>
<td><p>Specify the type of SYCL device. The possible values are <code class="docutils literal notranslate"><span class="pre">device</span></code> or <code class="docutils literal notranslate"><span class="pre">shared</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">device</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-e</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_queue_type</span></code></p></td>
<td><p>Specify the type of the SYCL queue. The possible values are <code class="docutils literal notranslate"><span class="pre">in_order</span></code> and <code class="docutils literal notranslate"><span class="pre">out_order</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">out_order</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-l</span></code>, <code class="docutils literal notranslate"><span class="pre">--coll</span></code></p></td>
<td><p>Specify the collective to run. Accept a comma-separated list, without whitespace characters, of collectives to run. The available collectives are <code class="docutils literal notranslate"><span class="pre">allreduce</span></code>, <code class="docutils literal notranslate"><span class="pre">reduce</span></code>, <code class="docutils literal notranslate"><span class="pre">alltoallv</span></code>, <code class="docutils literal notranslate"><span class="pre">alltoall</span></code>, <code class="docutils literal notranslate"><span class="pre">allgatherv</span></code>, <code class="docutils literal notranslate"><span class="pre">reduce-scatter</span></code>, <code class="docutils literal notranslate"><span class="pre">broadcast</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">allreduce</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-d</span></code>, <code class="docutils literal notranslate"><span class="pre">--dtype</span></code></p></td>
<td><p>Specify the datatype. Accept a comma-separated list, without whitespace characters, of datatypes to benchmark. The available types are <code class="docutils literal notranslate"><span class="pre">int8</span></code>, <code class="docutils literal notranslate"><span class="pre">int32</span></code>, <code class="docutils literal notranslate"><span class="pre">int64</span></code>, <code class="docutils literal notranslate"><span class="pre">uint64</span></code>, <code class="docutils literal notranslate"><span class="pre">float16</span></code>, <code class="docutils literal notranslate"><span class="pre">float32</span></code>, and <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-r</span></code>, <code class="docutils literal notranslate"><span class="pre">--reduction</span></code></p></td>
<td><p>Specify the type of the reduction. Accept a coma-separated list, without whitespace characters, of the reduction operations to run. The available operations are <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">prod</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, and <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sum</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-o</span></code>, <code class="docutils literal notranslate"><span class="pre">--csv_filepath</span></code></p></td>
<td><p>Specify to store the output in the specified CSV file. User specifies the csv_filepath/file_to_store CSV-formatted data into</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-x</span></code>, <code class="docutils literal notranslate"><span class="pre">--ext</span></code></p></td>
<td><p>Specify to show the additional information. The possible values are <code class="docutils literal notranslate"><span class="pre">off</span></code>, <code class="docutils literal notranslate"><span class="pre">auto</span></code>, and <code class="docutils literal notranslate"><span class="pre">on</span></code>. With <code class="docutils literal notranslate"><span class="pre">on</span></code>, it also displays the average wait time.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">auto</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></p></td>
<td><p>Show all of the supported options.</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-t</span></code> and <code class="docutils literal notranslate"><span class="pre">-f</span></code> options specify the count in number of elements, so the total number of bytes is obtained by multiplying the number of elements by the number of bytes of the data type the collective uses.
For instance, with <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">128</span></code> and <code class="docutils literal notranslate"><span class="pre">fp32</span></code> datatype, the total amount of bytes is 512 (128 element count * 4 bytes FP32).
The benchmark runs and reports time for message sizes that correspond to the <code class="docutils literal notranslate"><span class="pre">-t</span></code> and <code class="docutils literal notranslate"><span class="pre">-f</span></code> arguments and all message sizes that are powers of two in between these two numbers.</p>
</div>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h2>
<section id="gpu">
<h3>GPU<a class="headerlink" href="#gpu" title="Permalink to this headline">#</a></h3>
<p>The following example shows how to run the benchmark with the GPU buffers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">benchmark</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">gpu</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">usm</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">allreduce</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">float32</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">in_order</span>
</pre></div>
</div>
<p>The above command runs:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> collective operation</p></li>
<li><p>With a total of <code class="docutils literal notranslate"><span class="pre">N</span></code> processes</p></li>
<li><p>With <code class="docutils literal notranslate"><span class="pre">P</span></code> processes per node allocating the memory in the GPU</p></li>
<li><p>Using SYCL Unified Shared Memory (USM) of the device type</p></li>
<li><p>20 iterations</p></li>
<li><p>With the element count from 1024 to 67108864 (the benchmark runs with all the powers on two in that range) of float32 datatype, assuming the collective is not persistent and using a SYCL in-order queue</p></li>
</ul>
<p>Similar for <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> and <code class="docutils literal notranslate"><span class="pre">reduce_scatter</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">benchmark</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">gpu</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">usm</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">allreduce</span><span class="p">,</span><span class="n">reduce_scatter</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">float32</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">in_order</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case, the time reported is the accumulated time corresponding to the execution time of <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> and <code class="docutils literal notranslate"><span class="pre">reduce_scatter</span></code>.</p>
</div>
</section>
<section id="cpu">
<h3>CPU<a class="headerlink" href="#cpu" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">benchmark</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">allreduce</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">float32</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">0</span>
</pre></div>
</div>
<p>The above command specifies to run</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> collective operation</p></li>
<li><p>With a total of <code class="docutils literal notranslate"><span class="pre">N</span></code> processes</p></li>
<li><p>With <code class="docutils literal notranslate"><span class="pre">P</span></code> processes per node</p></li>
<li><p>20 iterations</p></li>
<li><p>With the element count from 1024 to 67108864 (the benchmark runs with all the powers on two in that range) of float32 datatype, assuming the collective is not persistent</p></li>
</ul>
<p>Similar for <code class="docutils literal notranslate"><span class="pre">allreduce</span></code> and <code class="docutils literal notranslate"><span class="pre">reduce_scatter</span></code>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">benchmark</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">allreduce</span><span class="p">,</span><span class="n">reduce_scatter</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">float32</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">0</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="env-variables.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Environment Variables</p>
      </div>
    </a>
    <a class="right-next"
       href="legal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notices and Disclaimers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-oneccl-benchmark">Build oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-only">CPU-Only</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-gpu">CPU-GPU</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oneccl-benchmark">Run oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#benchmark-arguments">Benchmark Arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu">GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu">CPU</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Intel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p align="right"><a href="https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">Cookies</a></p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>