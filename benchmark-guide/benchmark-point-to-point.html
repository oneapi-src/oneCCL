

<!DOCTYPE html>


<html >

  <head>
    <meta charset="ascii" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>oneCCL Benchmark Point-to-Point User Guide &#8212; oneCCL  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <link rel="shortcut icon" href="../_static/favicons.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Notices and Disclaimers" href="../legal.html" />
    <link rel="prev" title="oneCCL Benchmark Collective User Guide" href="benchmark.html" />
    <script defer type="text/javascript" src="https://www.intel.com/content/dam/www/global/wap/performance-config.js" ></script>
    <script type="text/javascript">
        // Configure TMS settings
        var wapLocalCode = 'us-en'; // Dynamically set per localized site, see mapping table for values
        var wapSection = "oneapi-ccl"; // WAP team will give you a unique section for your site
        // Load TMS
        (function () {
        var url = 'https://www.intel.com/content/dam/www/global/wap/tms-loader.js'; // WAP file URL
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = url;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
        })();
    </script>
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/oneAPI-rgb-rev-100.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/sample.html">Sample Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/cmake-configuration.html">Use oneCCL package from CMake</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../programming-model.html">Programming Model</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../programming-model/host-communication.html">Host Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming-model/device-communication.html">Device Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programming-model/limitations.html">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../general-configuration.html">General Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-configuration/operation-execution.html">Execution of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-configuration/transport-selection.html">Transport Selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced-configuration.html">Advanced Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/collective-algorithms-selection.html">Selection of Collective Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/low-precision-datatypes.html">Low-precision Datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/operation-caching.html">Caching of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/operation-prioritization.html">Prioritization of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/operation-fusion.html">Fusion of Communication Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced-configuration/dmabuf.html">Enabling OFI/verbs/dmabuf Support</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">oneCCL API</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/initialization.html">Initialization</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/concepts.html">oneCCL Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/communicator.html">Communicator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/context.html">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/device.html">Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/event.html">Event</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/kvs.html">Key-value Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/concepts/stream.html">Stream</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/operations.html">Communication Operations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/operations/datatypes.html">Datatypes</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/operations/collective-operations.html">Collective Operations</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/allgather.html">Allgather</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/allgatherv.html">Allgatherv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/allreduce.html">Allreduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/alltoall.html">Alltoall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/alltoallv.html">Alltoallv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/barrier.html">Barrier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/broadcast.html">Broadcast</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/group-call.html">Group Calls</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/reduce.html">Reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/operations/collective-operations/reduce-scatter.html">ReduceScatter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/operations/point-to-point.html">Point-To-Point Operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../env-variables.html">Environment Variables</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Benchmark User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">oneCCL Benchmark Collective User Guide</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">oneCCL Benchmark Point-to-Point User Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notices and Disclaimers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../legal.html">Notices and Disclaimers</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/oneapi-src/oneCCL/edit/master/doc/rst/source/benchmark-guide/benchmark-point-to-point.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/oneapi-src/oneCCL/issues/new?title=Issue%20on%20page%20%2Fbenchmark-guide/benchmark-point-to-point.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/benchmark-guide/benchmark-point-to-point.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>oneCCL Benchmark Point-to-Point User Guide</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-oneccl-benchmark">Build oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-only">CPU-Only</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-gpu">CPU-GPU</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oneccl-point-to-point-benchmark">Run oneCCL Point-to-Point Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#point-to-point-benchmark-arguments">Point-to-Point Benchmark Arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu">GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu">CPU</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="oneccl-benchmark-point-to-point-user-guide">
<h1>oneCCL Benchmark Point-to-Point User Guide<a class="headerlink" href="#oneccl-benchmark-point-to-point-user-guide" title="Permalink to this headline">#</a></h1>
<p>oneCCL provides two benchmarks for performance measurement of the point-to-point operations in oneCCL:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ccl_latency</span> <span class="pre">measures</span> <span class="pre">latency</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ccl_bw</span> <span class="pre">measures</span> <span class="pre">bandwidth</span></code></p></li>
</ul>
<p>The benchmark is distributed with the oneCCL package. You can find it in the examples directory within the oneCCL installation path.</p>
<section id="build-oneccl-benchmark">
<h2>Build oneCCL Benchmark<a class="headerlink" href="#build-oneccl-benchmark" title="Permalink to this headline">#</a></h2>
<section id="cpu-only">
<h3>CPU-Only<a class="headerlink" href="#cpu-only" title="Permalink to this headline">#</a></h3>
<p>To build the benchmark, complete the following steps:</p>
<ol class="arabic">
<li><p>Configure your environment. Source the installed oneCCL library for the CPU-only support:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">source</span><span class="w"> </span><span class="o">&lt;</span><span class="n">oneCCL</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">dir</span><span class="o">&gt;/</span><span class="n">ccl</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">env</span><span class="o">/</span><span class="n">vars</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="o">--</span><span class="n">ccl</span><span class="o">-</span><span class="n">configuration</span><span class="o">=</span><span class="n">cpu</span>
</pre></div>
</div>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">&lt;oneCCL</span> <span class="pre">install</span> <span class="pre">dir&gt;/share/doc/ccl/examples</span></code></p></li>
<li><p>Build the benchmark using the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="n">$</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">_install</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="o">--</span><span class="n">build</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">nproc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">install</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="cpu-gpu">
<h3>CPU-GPU<a class="headerlink" href="#cpu-gpu" title="Permalink to this headline">#</a></h3>
<ol class="arabic">
<li><p>Configure your environment.</p>
<ul>
<li><p>Source the Intel(R) oneAPI DPC++/C++ Compiler. See the <a class="reference external" href="https://www.intel.com/content/www/us/en/docs/dpcpp-cpp-compiler/get-started-guide/2024-2/overview.html">documentation</a> for the instructions.</p></li>
<li><p>Source the installed oneCCL library for the CPU-GPU support:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">source</span><span class="w"> </span><span class="o">&lt;</span><span class="n">oneCCL</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">dir</span><span class="o">&gt;/</span><span class="n">ccl</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">env</span><span class="o">/</span><span class="n">vars</span><span class="p">.</span><span class="n">sh</span><span class="w"> </span><span class="o">--</span><span class="n">ccl</span><span class="o">-</span><span class="n">configuration</span><span class="o">=</span><span class="n">cpu_gpu_dpcpp</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">&lt;oneCCL</span> <span class="pre">install</span> <span class="pre">dir&gt;/share/doc/ccl/examples</span></code>.</p></li>
<li><p>Build the SYCL benchmark with the following command:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="n">B</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">icx</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">icpx</span><span class="w"> </span><span class="o">-</span><span class="n">DCOMPUTE_BACKEND</span><span class="o">=</span><span class="n">dpcpp</span><span class="w"> </span><span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="n">$</span><span class="p">(</span><span class="n">pwd</span><span class="p">)</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">_install</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmake</span><span class="w"> </span><span class="o">--</span><span class="n">build</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">j</span><span class="w"> </span><span class="n">$</span><span class="p">(</span><span class="n">nproc</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">install</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="run-oneccl-point-to-point-benchmark">
<h2>Run oneCCL Point-to-Point Benchmark<a class="headerlink" href="#run-oneccl-point-to-point-benchmark" title="Permalink to this headline">#</a></h2>
<p>To run <code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> or <code class="docutils literal notranslate"><span class="pre">ccl_bw</span></code>, use the following commands:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ccl_latency</span><span class="w"> </span><span class="p">[</span><span class="n">arguments</span><span class="p">]</span>

<span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ccl_bw</span><span class="w"> </span><span class="p">[</span><span class="n">arguments</span><span class="p">]</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> is the number of processes (this benchmark runs only with two processes).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of processes within a node. For this benchmark, <code class="docutils literal notranslate"><span class="pre">&lt;P&gt;</span></code> can only be <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>. When <code class="docutils literal notranslate"><span class="pre">N==1</span></code>, it indicates there is a single process on each node and the benchmark runs across nodes. When <code class="docutils literal notranslate"><span class="pre">N==2</span></code>, it indicates both processes are on the same node.</p></li>
</ul>
<p>The benchmark reports:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#bytes</span></code> - the message size in the number of bytes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elem_count</span></code> - the message size in the number of elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#repetitions</span></code> - the number of iterations</p></li>
<li><p>Latency (for ccl_latency benchmark) -  time to send the data from a sender process to a receiving process, where both the send and receive operations are blocking. The time is reported in <cite>&#956;sec</cite>.</p></li>
<li><p>Bandwidth (for <code class="docutils literal notranslate"><span class="pre">ccl_bw</span></code>) - represented in Mbytes/second for the bandwidth benchmark</p></li>
</ul>
<p>Both benchmarks always transfer elements of type <cite>int32</cite>.</p>
<section id="point-to-point-benchmark-arguments">
<h3>Point-to-Point Benchmark Arguments<a class="headerlink" href="#point-to-point-benchmark-arguments" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> and <code class="docutils literal notranslate"><span class="pre">ccl_bw</span></code> accept the same arguments. To see the benchmark arguments, use the <code class="docutils literal notranslate"><span class="pre">--help</span></code> argument.</p>
<p><code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> and <code class="docutils literal notranslate"><span class="pre">ccl_bw</span> <span class="pre">accept</span></code> accept the following arguments:</p>
<table class="colwidths-given table">
<colgroup>
<col style="width: 25%" />
<col style="width: 50%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-b</span></code>, <code class="docutils literal notranslate"><span class="pre">--backend</span></code></p></td>
<td><p>Specify the backend. The possible values are cpu and gpu. For a CPU-only build, the backend is automatically set to cpu, and only the cpu option is available.
For a CPU-GPU build, cpu and gpu options are available, and gpu is the default value. The cpu value allocates buffers in the host (CPU) memory, while the gpu value allocates buffers in the device (GPU) memory.</p></td>
<td><p>The default is gpu for CPU-GPU build, cpu for CPU-only build</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-i</span></code>, <code class="docutils literal notranslate"><span class="pre">--iters</span></code></p></td>
<td><p>Specify the number of iterations executed by the benchmark.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-w</span></code>, <code class="docutils literal notranslate"><span class="pre">--warmup_iters</span></code></p></td>
<td><p>Specify the number of the warmup iterations. It means the number of iterations the benchmark runs before starting the timing of the iterations specified with the <code class="docutils literal notranslate"><span class="pre">-i</span></code> argument.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>, <code class="docutils literal notranslate"><span class="pre">--cache</span></code></p></td>
<td><p>Specify whether to use persistent collectives (<code class="docutils literal notranslate"><span class="pre">p=1</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">p=0</span></code>).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code>
.. note::  The benchmark currently does not support persistent collectives.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-e</span></code>, <code class="docutils literal notranslate"><span class="pre">--sycl_queue_type</span></code></p></td>
<td><p>Specify the type of SYCL queue. Possible values are 0 (out_order) or 1 (in_order).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">(out_order)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-s</span></code>, <code class="docutils literal notranslate"><span class="pre">--wait</span></code></p></td>
<td><p>Specifies the synchronization model, that is, whether the point to point operation is 1 (blocking) or  0 (non_blocking). Notice that currently the benchmark only supports blocking point to point operations.</p></td>
<td><p>Default mode is 1 (blocking)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-f</span></code>, <code class="docutils literal notranslate"><span class="pre">--min_elem_count</span></code></p></td>
<td><p>Specifies the minimum number of elements used for the operation.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-t</span></code>, <code class="docutils literal notranslate"><span class="pre">--max_elem_count</span></code></p></td>
<td><p>Specify the maximum number of elements used for the operation.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">33554432</span></code>
.. note::  The <code class="docutils literal notranslate"><span class="pre">-t</span></code> and <code class="docutils literal notranslate"><span class="pre">-f</span></code> options specify the count in the number of elements. Therefore, the total number of bytes is obtained by multiplying the number of elements by the number of bytes of the data type. For instance, when using <code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">128</span></code> and data type <code class="docutils literal notranslate"><span class="pre">fp32</span></code>, the total amount of bytes is 512 bytes (<code class="docutils literal notranslate"><span class="pre">128</span> <span class="pre">element</span> <span class="pre">count</span> <span class="pre">*</span> <span class="pre">4</span> <span class="pre">bytes</span> <span class="pre">FP32</span></code>). <code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code>/<code class="docutils literal notranslate"><span class="pre">ccl_bw</span> <span class="pre">run</span></code> and report performance for message sizes that correspond to the <code class="docutils literal notranslate"><span class="pre">-t</span></code> and <code class="docutils literal notranslate"><span class="pre">-f</span></code> arguments and all message sizes that are power of two in between these two numbers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-y</span></code>, <code class="docutils literal notranslate"><span class="pre">--elem_counts</span></code></p></td>
<td><p>Specify a list with the number of elements used for the collective, such as <code class="docutils literal notranslate"><span class="pre">[-y</span> <span class="pre">4,8,32,131072]</span></code>.</p></td>
<td><p>The default value is  between <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">33554432</span></code> and all powers of two in between.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-c</span></code>, <code class="docutils literal notranslate"><span class="pre">--check</span></code></p></td>
<td><p>Check for correctness. The possible values are <code class="docutils literal notranslate"><span class="pre">off</span></code> (disable checking), <code class="docutils literal notranslate"><span class="pre">last</span></code> (check the last iteration), and <code class="docutils literal notranslate"><span class="pre">all</span></code> (check all the iterations).</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">last</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-h</span></code>, <code class="docutils literal notranslate"><span class="pre">--help</span></code></p></td>
<td><p>Show all of the supported options.</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h2>
<section id="gpu">
<h3>GPU<a class="headerlink" href="#gpu" title="Permalink to this headline">#</a></h3>
<p>The following example shows how to run <code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> with the GPU buffers:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ccl_latency</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">gpu</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="mi">1</span>
<span class="n">mpirun</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="n">ppn</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ccl_bw</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">gpu</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">67108864</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>The above commands:</p>
<ul class="simple">
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> or the <code class="docutils literal notranslate"><span class="pre">ccl_bw</span></code> benchmark</p></li>
<li><p>Contain a total of two processes (this benchmark only supports two processes)</p></li>
<li><p>Use P processes per node, where P can be <code class="docutils literal notranslate"><span class="pre">1</span></code> if running on two different nodes or <code class="docutils literal notranslate"><span class="pre">2</span></code> when running on a single node</p></li>
<li><p>Use GPU buffers</p></li>
<li><p>Use 20 iterations</p></li>
<li><p>Use element count from <code class="docutils literal notranslate"><span class="pre">1024</span></code> to <code class="docutils literal notranslate"><span class="pre">67108864</span></code> (<code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> or <code class="docutils literal notranslate"><span class="pre">ccl_bw</span></code> will run with the powers of two in that range)</p></li>
<li><p>Have in-order queue</p></li>
</ul>
</section>
<section id="cpu">
<h3>CPU<a class="headerlink" href="#cpu" title="Permalink to this headline">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span> mpirun &#8211;n 2 -ppn &lt;P&gt; ccl_latency -b cpu -i 20 -f 1024 -t 67108864
| mpirun &#8211;n 2 -ppn &lt;P&gt; ccl_bw -b cpu -i 20 -f 1024 -t 67108864
</pre></div>
</div>
<p>The preceding command:</p>
<ul class="simple">
<li><p>Runs the <code class="docutils literal notranslate"><span class="pre">ccl_latency/ccl_bw</span></code> benchmark</p></li>
<li><p>Contains a total of two processes (this benchmark only supports two processes)</p></li>
<li><p>Contains P processes per node, where <code class="docutils literal notranslate"><span class="pre">P</span></code> can be <code class="docutils literal notranslate"><span class="pre">1</span></code> if running on two different nodes or <code class="docutils literal notranslate"><span class="pre">2</span></code> when running on a single node</p></li>
<li><p>Uses CPU buffers</p></li>
<li><p>Uses 20 iterations</p></li>
<li><p>Uses element count from <code class="docutils literal notranslate"><span class="pre">1024</span></code> to <code class="docutils literal notranslate"><span class="pre">67108864</span></code> (<code class="docutils literal notranslate"><span class="pre">ccl_latency</span></code> will run with the power of two in that range)</p></li>
</ul>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="benchmark.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">oneCCL Benchmark Collective User Guide</p>
      </div>
    </a>
    <a class="right-next"
       href="../legal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notices and Disclaimers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-oneccl-benchmark">Build oneCCL Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-only">CPU-Only</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-gpu">CPU-GPU</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-oneccl-point-to-point-benchmark">Run oneCCL Point-to-Point Benchmark</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#point-to-point-benchmark-arguments">Point-to-Point Benchmark Arguments</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gpu">GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu">CPU</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Intel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      &#169; Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p align="right"><a href="https://www.intel.com/content/www/us/en/privacy/intel-cookie-notice.html">Cookies</a></p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>